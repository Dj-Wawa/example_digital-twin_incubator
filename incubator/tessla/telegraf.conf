
[agent]
interval = "1s"
flush_interval = "1s"

[[inputs.amqp_consumer]]
	brokers = ["amqp://localhost:5672"]
	username = "incubator"
	password = "incubator"
	exchange = "Incubator_AMQP"
	exchange_durability = "transient"
	queue = "telegraf"
	queue_durability = "transient"
	binding_key = "incubator.diagnosis.plant.lidopen"
	data_format = "json"
	json_string_fields = ["lid_open"]

[[inputs.amqp_consumer]]
	brokers = ["amqp://localhost:5672"]
	username = "incubator"
	password = "incubator"
	exchange = "Incubator_AMQP"
	exchange_durability = "transient"
	queue = "telegraf"
	queue_durability = "transient"
	binding_key = "incubator.energysaver.status"
	data_format = "json"
	json_string_fields = ["energy_saver_on"]

[[outputs.amqp]]
	brokers = ["amqp://localhost:5672"]
	username = "incubator"
	password = "incubator"
	exchange = "Incubator_AMQP"
	exchange_durability = "transient"
	routing_key = "incubator.update.closed_loop_controller.parameters"
	namepass = ["result"]
	data_format = "json"
	use_batch_format = false
	json_transformation = '{"temperature_desired" : fields.value ? 21 : 35}'
	
[[outputs.file]]
	files = ["stdout"]

[[outputs.influxdb]]
  urls = ["udp://127.0.0.1:1653"]
[[inputs.socket_listener]]
  service_address = "udp://:1654"
  data_format = "influx"
